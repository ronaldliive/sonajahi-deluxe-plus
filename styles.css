/* Mobile-first, dark theme, kid-friendly */
:root{
  --bg:#0b1220; --panel:#0f172acc; --text:#e5e7eb; --muted:#94a3b8;
  --accent:#22c55e; --accent-2:#60a5fa; --error:#ef4444; --gold:#facc15;
  --tile:#0b1220; --tile-b:#334155;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
}
.app{ position:relative }
/* Big word in answer overlay */
.answer-card .answer-word{
  font-weight: 800;
  font-size: clamp(28px, 7.5vw, 46px);
  letter-spacing: 2px;
  text-transform: uppercase;
  margin: 6px 0 2px 0;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%}
html,body{margin:0}
body{
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif; color:var(--text);
  background:
    radial-gradient(700px 350px at 85% -10%, #0ea5e9 0%, transparent 55%),
    radial-gradient(600px 300px at -10% 100%, #16a34a 0%, transparent 50%),
    var(--bg);
  display:flex; align-items:center; justify-content:center; padding:16px;
  min-height:100svh;
  -webkit-user-select:none; user-select:none; -webkit-touch-callout:none; touch-action:manipulation; overscroll-behavior:none;
}
.app{ width:100%; max-width:840px; }
.shell{ position:relative; background:var(--panel); border:1px solid #1f2937; border-radius:18px; box-shadow:0 16px 40px rgba(0,0,0,.45); overflow:hidden }
.card{ background:var(--panel); backdrop-filter: blur(10px); border:1px solid #1f2937; border-radius:18px; padding:12px; box-shadow:0 16px 40px rgba(0,0,0,.45)}

h1{ font-size:20px; margin:0 0 8px }
.tiny{ font-size:12px; color:var(--muted) }
.muted{ color:var(--muted) }

/* App bar */
.appbar{ position:sticky; top:0; z-index:10; display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px 12px; background:rgba(2,6,23,.5); backdrop-filter: blur(10px); border-bottom:1px solid #1f2937 }
.title{ font-size:18px; margin:0 }
.appbar-right{ display:flex; gap:6px; flex-wrap:wrap; justify-content:flex-end }
.pill{ padding:6px 8px; border-radius:999px; border:1px solid #1f2937; background:#0b1220; font-size:12px }
.pill.good{ border-color:#16a34a66; background:rgba(34,197,94,.12) }
.pill.bad{ border-color:#ef444466; background:rgba(239,68,68,.12) }

/* Rows and buttons */
.row{ display:flex; gap:10px }
.gap{ margin:8px 0 }
.align-center{ align-items:center }
.btn{
  flex:1; background:#1f2937; color:var(--text); border:1px solid #263244; padding:14px 16px; border-radius:12px; font-weight:600;
  min-height:48px; cursor:pointer; transition:transform .05s ease, background .2s ease;
}
.btn:active{ transform:scale(.98) }
.btn-primary{ background:var(--accent); color:#052e16; border-color:#15803d }
.btn-secondary{ background:#0b1220; color:var(--text); border-color:#1f2937 }

/* Progress */
.progress-wrap{ display:none }
.progress{ display:none }
.dots{ display:flex; justify-content:center; gap:6px; padding:4px 12px 0 }
.dot{ width:8px; height:8px; border-radius:50%; background:#1f2937; border:1px solid #263244; opacity:.8 }
.dot.current{ background:#60a5fa; box-shadow:0 0 0 3px rgba(96,165,250,.15); }
.dot.good{ background:#22c55e; border-color:#15803d }
.dot.bad{ background:#ef4444; border-color:#b91c1c }

/* Progress dots */
.dots{ display:flex; justify-content:center; gap:6px; padding:4px 12px 0 }
.dot{ width:8px; height:8px; border-radius:50%; background:#1f2937; border:1px solid #263244; opacity:.8 }
.dot.current{ background:#60a5fa; box-shadow:0 0 0 3px rgba(96,165,250,.15); }
.dot.good{ background:#22c55e; border-color:#15803d }
.dot.bad{ background:#ef4444; border-color:#b91c1c }

/* Bottom bar */
.bottombar{ position:sticky; bottom:0; z-index:10; background:rgba(2,6,23,.5); backdrop-filter: blur(10px); border-top:1px solid #1f2937; padding:10px 12px; display:grid; gap:8px }
.controls{ display:flex; gap:10px; flex-wrap:nowrap }
.version{ margin-top:4px; text-align:center; font-size:11px; color:var(--muted); opacity:.9 }
/* Global page footer version (outside game UI) */
.page-version{
  position:fixed; z-index:60;
  right: calc(10px + var(--safe-right));
  bottom: calc(8px + var(--safe-bottom));
  background: rgba(2,6,23,.7);
  border:1px solid #1f2937; color: var(--muted);
  padding:6px 8px; border-radius:8px; font-size:11px; font-weight:700;
  backdrop-filter: blur(6px);
}
.btn{ appearance:none; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; padding:14px 16px; border-radius:12px; font-weight:800 }
.ctrl select,.ctrl input[type="range"]{ accent-color:var(--accent) }
.icon{ font-size:16px }

/* Counter animations */
@keyframes bump{ 0%{ transform:scale(1) } 30%{ transform:scale(1.12) } 100%{ transform:scale(1) } }
@keyframes shake{ 0%,100%{ transform:translateX(0) } 25%{ transform:translateX(-2px) } 75%{ transform:translateX(2px) } }
.anim-bump{ animation: bump .35s ease }
.anim-shake{ animation: shake .35s ease }

/* Task */
.content{ padding:8px 10px 10px }
.controls-content{ padding:6px 10px 0 }
.main-content{ padding:0 10px 8px }
.feedback{ text-align:center; font-weight:800; margin:2px 10px 0; letter-spacing:.2px }
.feedback.good{ color:#22c55e }
.feedback.bad{ color:#ef4444 }
.letters{ display:flex; gap:12px; flex-wrap:nowrap; margin:0; justify-content:center; overflow:hidden }
.letter{
  width:72px; height:72px; min-width:72px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:34px;
  color:#fff; border:2px dashed #334155; background:rgba(2,6,23,.6); border-radius:14px;
}

/* Stage area around letters */
.stage{
  border:1px solid #1f2937; border-radius:20px; padding:4px 6px; background:rgba(2,6,23,.35);
  display:flex; align-items:center; justify-content:center; margin-top:2px; min-height:18svh;
}
.stage > .letters{ width:100%; justify-content:center; align-items:center; }

/* Fullscreen mobile adjustments */
@media (max-width: 768px){
  body{ display:block; padding:0; min-height:100svh; }
  .app{ max-width:none; width:100%; }
  .shell{ border:none; border-radius:0; box-shadow:none; min-height:100svh; width:100vw; display:flex; flex-direction:column; }
  .appbar{ padding:6px calc(8px + var(--safe-right)) 6px calc(8px + var(--safe-left)); padding-top: calc(6px + var(--safe-top)); }
  .title{ font-size:16px; }
  .pill{ padding:4px 6px; font-size:11px }
  .bottombar{ padding:8px calc(10px + var(--safe-right)) calc(8px + var(--safe-bottom)) calc(10px + var(--safe-left)); }
  .progress-wrap.fixed{ display:none }
  .progress-wrap{ display:none }
  .dots{ gap:4px; padding:2px 12px 0 }
  .progress{ background:linear-gradient(90deg, rgba(34,197,94,.9), rgba(96,165,250,.9)) }
  .content{ padding:4px calc(8px + var(--safe-right)) calc(6px + var(--safe-bottom)); flex:1; overflow:hidden; display:flex; flex-direction:column; gap:4px }
  .controls-content{ padding-bottom:0 }
  .main-content{ padding-top:0 }
  .dots{ padding:0 10px 0 }
  .feedback{ margin:2px 12px 0; font-size:14px }
  .stage{ flex: 0 0 auto; border-radius:12px; min-height:24svh; }
  .letters{ margin:0 }
  .choices{ flex:1; display:grid !important; grid-template-columns:repeat(3,1fr); gap:6px; margin-top:6px; padding-top:8px; border-top:1px solid #1f2937 }
  .letters{ gap:10px; margin:0 }
  .letter{ width:clamp(52px, 13.5vw, 80px); height:clamp(52px, 13.5vw, 80px); min-width:clamp(52px, 13.5vw, 80px); font-size:clamp(26px, 6.4vw, 38px) }
  /* Keep choices as a 3-column grid on mobile as well */
  .choices{ flex:1; display:grid !important; grid-template-columns:repeat(3,1fr); gap:8px; margin-top:0; padding-top:4px; border-top:1px solid #1f2937 }
  .choice{ min-height:auto !important; padding:12px }
}

/* Larger desktop screens */
@media (min-width: 1024px){
  body{ padding:24px }
  .app{ max-width:960px }
  .stage{ min-height: 26svh }
  .choice{ min-height:110px; font-size:clamp(22px,2.2vw,28px) }
  .choice .emoji{ font-size:clamp(72px, 8vw, 128px) }
}

/* Choices */
.choices{ display:grid; grid-template-columns: repeat(3,1fr); gap:10px; margin-top:12px; padding-top:12px; border-top:1px solid #1f2937 }
.choice{ min-height:84px }
.choice{
  display:flex; align-items:center; justify-content:center;
  background:#0b1220; border:2px solid #1f2937; border-radius:14px;
  min-height:68px; color:#fff; font-size:clamp(20px,4.6vw,28px);
  font-weight:800; letter-spacing:.02em; padding:8px; position:relative; overflow:hidden
}
.choice .word{ display:inline-block; white-space:nowrap; transform-origin:center center; }
.choice:active{ transform:scale(.98) }
.choice.enter{ opacity:0; transform:translateY(10px) scale(.98) }
.choice.enter.show{ opacity:1; transform:translateY(0) scale(1); transition:transform .22s cubic-bezier(.2,.8,.2,1), opacity .22s ease }
.choice .emoji{ font-size:clamp(64px, 16vw, 128px); line-height:1 }
.choice.correct{ outline:2px solid #16a34a; border-color:#16a34a44; background:linear-gradient(0deg,rgba(34,197,94,.08),transparent) }
.choice.wrong{ outline:2px solid #ef4444; border-color:#ef444444; background:linear-gradient(0deg,rgba(239,68,68,.08),transparent) }

/* Welcome overlay */
.overlay{ position:fixed; inset:0; background:rgba(2,6,23,.96); backdrop-filter: blur(6px); display:flex; align-items:center; justify-content:center; z-index:50 }
.overlay-card{ width:min(640px, 96vw); border:1px solid #1f2937; background:linear-gradient(180deg, #0b1220, #0b1426); border-radius:22px; padding:26px; text-align:center; box-shadow:0 16px 44px rgba(0,0,0,.5) }
.overlay-title{ margin:6px 0 6px; font-size:22px }
.overlay-text{ opacity:.9; margin:8px 0 16px }
.overlay-title.big{ font-size:clamp(28px, 6vw, 42px); }
.overlay-text.big{ font-size:clamp(16px, 4.5vw, 22px); }
.overlay-start{ font-size:18px; padding:16px 18px; }
.overlay-hero{ display:flex; justify-content:center; margin-bottom:8px }
.overlay-actions{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap }

/* Brand header on start overlay */
.brand{ display:flex; align-items:center; justify-content:center; gap:12px; margin:4px 0 12px }
.brand-logo{ font-size:clamp(32px, 6vw, 44px); line-height:1; filter: drop-shadow(0 2px 0 rgba(0,0,0,.25)); }
.brand-title{ font-weight:900; letter-spacing:.5px; font-size:clamp(24px, 6.5vw, 48px); background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; background-clip:text; color:transparent }

@media (min-width: 1024px){
  .overlay-card{ padding:34px 32px; border-radius:24px }
  .level-choices{ gap:14px }
  .level-btn{ padding:18px }
}

/* Answer overlay */
.overlay.answer{ background:linear-gradient(180deg, rgba(2,6,23,.9), rgba(2,6,23,.96)); }
.answer-card{ padding:28px 24px; }
.answer-emoji{ font-size:64px; line-height:1; margin-bottom:8px; filter: drop-shadow(0 2px 0 rgba(0,0,0,.25)); }
.counter{ display:inline-flex; align-items:center; justify-content:center; gap:8px; margin:8px auto 0; padding:8px 14px; border:1px solid #1f2937; background:#0b1220; color:#e5e7eb; border-radius:999px; font-weight:800 }
.overlay.answer .overlay-text.tiny{ color:var(--muted); letter-spacing:.3px }

/* Level choices - emoji buttons */
.level-choices{ display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin:8px 0 12px }
.level-btn{ display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px; padding:14px; border-radius:16px; background:#0b1220; border:2px solid #1f2937; color:#e5e7eb; font-weight:800; min-width:0 }
.level-btn .lvl-emoji{ font-size:36px; line-height:1 }
.level-btn .lvl-text{ font-size:13px; opacity:.9 }
.level-btn.selected{ border-color:#60a5fa; box-shadow:0 0 0 3px rgba(96,165,250,.2) inset }
.level-btn:active{ transform:scale(.98) }

/* Ensure long words fit and are centered */
.stage{ overflow:hidden }
.letters{ display:inline-flex; white-space:nowrap; margin:0 auto; will-change:transform; align-items:center; height:100% }
.letter{ transform:scale(.96); opacity:.95; transition:transform .15s ease, opacity .15s ease }
.letter.pop{ transform:scale(1); opacity:1 }
/* When showing an emoji instead of letters */
.emoji-stage{ font-size:clamp(72px, 16vw, 136px); line-height:1; filter: drop-shadow(0 2px 0 rgba(0,0,0,.25)); }

/* Generic control container (used by level selector) */
.ctrl{ display:flex; align-items:center; gap:8px; background:#0b1220; border:1px solid #1f2937; padding:6px 8px; border-radius:10px }
.ctrl select{ background:#0b1220; color:#e5e7eb; border:1px solid #1f2937; padding:8px 10px; border-radius:8px }

/* Toast */
.toast{ position:fixed; left:50%; bottom:16px; transform:translateX(-50%); background:rgba(2,6,23,.85); color:var(--text); border:1px solid #1f2937; padding:10px 12px; border-radius:10px; font-weight:600; box-shadow:0 8px 24px rgba(0,0,0,.35); opacity:0; pointer-events:none; transition:opacity .2s ease }
.toast.show{ opacity:1 }

/* Ripple effect for taps */
.ripple{ position:relative; overflow:hidden }
.ripple:after{
  content:''; position:absolute; left:50%; top:50%; width:10px; height:10px; background:rgba(255,255,255,.25);
  transform:translate(-50%,-50%) scale(1); border-radius:50%; opacity:0; pointer-events:none;
}
.ripple:active:after{ animation:ripple .4s ease }
@keyframes ripple{ from{ opacity:.6; transform:translate(-50%,-50%) scale(1) } to{ opacity:0; transform:translate(-50%,-50%) scale(24) } }

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important }
}
